<!DOCTYPE html>
<html lang="ja">
  <head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Document</title>
  </head>
  <body>
    <p>file練習</p>

    <input id="file_load" type="file">
    <p id="file_name">file名 = </p>
    <pre id="file_data">fileの内容 ↓↓↓↓↓↓↓↓↓ </pre>

    <script>
      window.addEventListener('DOMContentLoaded', (event) => {

        // File APIが利用できるか確認
        if (window.File && window.FileReader) {
          const elem_file_load = document.getElementById("file_load");

          elem_file_load.addEventListener("change", (event) => {
            const input_file = event.target.files[0];

            if (input_file.name.match('.html$')) {
              // オブジェクト。ユーザーが指定したファイルを非同期で読み取る。
              const f_reader = new FileReader();

              // ファイル内容の読み込み(f_reader.readAsText)が正常に完了した際、コールされる
              f_reader.onload = (event) => {
                const elem_file_name = document.getElementById("file_name");
                const elem_file_data = document.getElementById("file_data");

                // file名を取得
                elem_file_name.textContent += input_file.name;
                // file内容を取得
                elem_file_data.innerHTML += event.target.result.replace(/\n/g, "<br>");
              };

              // ファイル内容読み込み実施
              f_reader.readAsText(input_file);
            } else {
              alert("Only txt files are available");
              return false;
            }
          });
        } else {
          alert("File API is not available");
          return false;
        }

      });
    </script>
  </body>
</html>
